<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bihar Map + Results Embed</title>
  <meta name="description" content="Responsive two-iframe embed: Bihar map and results chart. Two columns on desktop, stacked on mobile." />
  <style>
    /* Responsive grid: one column on mobile, two on desktop */
    .bihar-embed-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 0;
      box-sizing: border-box;
    }
    @media (min-width: 900px) {
      .bihar-embed-grid { grid-template-columns: 1fr 1fr; }
    }

    .bihar-embed-tile {
      position: relative;
      width: 100%;
      overflow: hidden;
      border-radius: 12px;
      background: #f8fafc;
      border: 1px solid #d1d5db;
      box-shadow: 0 1px 3px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.05);
      min-height: 340px;
    }
    /* Map: keep aspect on mobile; let JS set height on desktop */
    #bihar-map-tile { aspect-ratio: 16 / 9; }
    @media (min-width: 900px) {
      #bihar-map-tile { aspect-ratio: auto; min-height: 0; }
    }

    /* Results: always allow to grow to full content height */
    #bihar-results-tile { aspect-ratio: auto; min-height: 0; }

    .bihar-embed-tile iframe {
      display: block;
      width: 100%;
      height: 100%;
      border: 0;
    }
  </style>
</head>
<body style="margin:0;">
  <div class="bihar-embed-grid" id="bihar-embed">
    <!-- Map iframe -->
    <div class="bihar-embed-tile" id="bihar-map-tile">
      <iframe
        id="bihar-map-frame"
        src="https://suhastpml.github.io/Bihar_constituency_page/map.html"
        title="Bihar Map"
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"
        allowfullscreen>
      </iframe>
    </div>

    <!-- Results iframe (posts its height via postMessage) -->
    <div class="bihar-embed-tile" id="bihar-results-tile">
      <iframe
        id="bihar-results-frame"
        src="https://suhastpml.github.io/Bihar_constituency_page/CMS_version/embed-results.html"
        title="Bihar Results"
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"
        allowfullscreen>
      </iframe>
    </div>
  </div>

  <script>
    (function () {
      var DESKTOP_MQ = window.matchMedia('(min-width: 900px)');
      var mapTile = document.getElementById('bihar-map-tile');
      var mapFrame = document.getElementById('bihar-map-frame');
      var resultsTile = document.getElementById('bihar-results-tile');
      var resultsFrame = document.getElementById('bihar-results-frame');

      var lastResultsHeight = null;

      function applyHeights() {
        if (!lastResultsHeight) return;
        var isDesktop = DESKTOP_MQ.matches;
        // Size results to its content height
        resultsTile.style.height = lastResultsHeight + 'px';
        resultsFrame.style.height = lastResultsHeight + 'px';
        if (isDesktop) {
          // Match map tile height to results on desktop
          mapTile.style.height = lastResultsHeight + 'px';
          mapFrame.style.height = '100%';
        } else {
          // Mobile: let map keep aspect ratio
          mapTile.style.height = '';
          mapFrame.style.height = '100%';
        }
      }

      // Listen to height messages from the results iframe
      window.addEventListener('message', function (ev) {
        var d = ev.data || {};
        if (d && d.type === 'RESULTS_IFRAME_SIZE' && typeof d.height === 'number') {
          lastResultsHeight = Math.max(300, d.height);
          applyHeights();
        }
      });

      // Re-apply on resize or breakpoint change
      window.addEventListener('resize', function () { setTimeout(applyHeights, 50); });
      DESKTOP_MQ.addEventListener('change', function () { setTimeout(applyHeights, 50); });

      // Fallback heuristic if no message arrives (caching delays)
      setTimeout(function () {
        if (!lastResultsHeight) {
          var w = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
          lastResultsHeight = (w >= 1200 ? 1000 : w >= 900 ? 1200 : 1600);
          applyHeights();
        }
      }, 1200);
    })();
  </script>
</body>
</html>

