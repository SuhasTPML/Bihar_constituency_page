<div id="bihar-widget-timeline"></div><style>#bihar-widget-timeline {--bg: #FFFFFF; --card: #FFFFFF; --text: #000000; --muted: #5B6064; --border: #E5E7EB; --primary: #0EA5E9; --primary-dark: #0284C7; --header-bg: #0EA5E9; --header-text: #FFFFFF; --shadow-sm: 0 1px 2px rgba(0,0,0,0.06); --shadow-md: 0 8px 24px rgba(0,0,0,0.06); --radius: 12px;}#bihar-widget-timeline * {box-sizing: border-box;}#bihar-widget-timeline {margin: 0px; font: 16px / 1.5 "Roboto Slab", "Roboto Serif", Georgia, serif; background: var(--bg); color: var(--text);}#bihar-widget-timeline .container {max-width: 1120px; margin: 0px auto; padding: 0px 16px;}#bihar-widget-timeline .main-header {display: none !important;}#bihar-widget-timeline .header-content {max-width: 1120px; margin: 0px auto; padding: 0px 16px; display: flex; justify-content: space-between; align-items: center;}#bihar-widget-timeline .header-left {display: flex; align-items: center; gap: 16px;}#bihar-widget-timeline .header-right {display: flex; align-items: center; gap: 16px;}#bihar-widget-timeline .menu-icon, #bihar-widget-timeline .search-icon, #bihar-widget-timeline .account-icon {cursor: pointer; font-size: 18px;}#bihar-widget-timeline .site-title {font-size: 18px; font-weight: 600; margin: 0px; letter-spacing: 0.5px;}#bihar-widget-timeline .search-section {padding: 24px 0px 16px;}#bihar-widget-timeline .search-controls {display: flex; gap: 12px; align-items: center; margin-bottom: 8px; flex-wrap: wrap;}#bihar-widget-timeline .search-controls label {font-weight: 500; color: var(--text);}#bihar-widget-timeline input[type="number"] {padding: 12px 16px; border: 1px solid var(--border); border-radius: 10px; width: 260px; font-size: 16px; min-height: 48px; background: rgb(255, 255, 255);}#bihar-widget-timeline input[type="number"]::placeholder {color: var(--muted); opacity: 1;}#bihar-widget-timeline input[type="number"]:focus {outline: none; border-color: var(--primary); box-shadow: rgba(0, 145, 172, 0.1) 0px 0px 0px 2px;}#bihar-widget-timeline .primary-btn {padding: 12px 20px; border: none; border-radius: 10px; background: var(--primary); color: rgb(255, 255, 255); cursor: pointer; font-size: 16px; font-weight: 600; min-height: 48px;}#bihar-widget-timeline .primary-btn:hover {background: var(--primary-dark);}#bihar-widget-timeline .helper-text {color: rgb(153, 153, 153); font-size: 16px; margin-bottom: 8px; font-family: "Roboto Slab", serif;}#bihar-widget-timeline .status-text {color: var(--muted); font-size: 14px;}#bihar-widget-timeline .card {background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); padding: 20px; margin-bottom: 16px;}#bihar-widget-timeline .constituency-header {margin-bottom: 24px;}#bihar-widget-timeline .constituency-title {font-family: "Playfair Display", serif; font-size: 44px; font-weight: 700; margin: 0px 0px 8px; color: var(--text); line-height: 1.1;}#bihar-widget-timeline .constituency-info {display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 8px;}#bihar-widget-timeline .current-mla-card {margin-bottom: 16px;}#bihar-widget-timeline .current-mla-title {font-family: "Playfair Display", serif; font-size: 22px; font-weight: 600; line-height: 36px; margin: 0px 0px 12px; color: var(--text);}#bihar-widget-timeline .mla-name {font-family: "Roboto Slab", serif; font-size: 16px; font-weight: 400; line-height: 21px; color: rgb(0, 0, 0); margin: 0px;}#bihar-widget-timeline .mla-party {color: var(--muted); font-size: 14px;}#bihar-widget-timeline .mla-alliance {color: var(--muted); font-size: 14px; margin-top: 2px;}#bihar-widget-timeline .current-mla-meta {font-family: "Roboto Slab", serif; font-size: 14px; line-height: 18px; color: rgb(91, 96, 100); margin: 4px 0px 0px;}#bihar-widget-timeline .cms-content-card {margin-bottom: 16px;}#bihar-widget-timeline .cms-content-title {font-size: 16px; font-weight: 600; margin: 0px 0px 12px; letter-spacing: 0.5px; color: var(--text);}#bihar-widget-timeline .cms-content-body {color: var(--text); line-height: 1.6; font-size: 15px;}#bihar-widget-timeline .cms-placeholder {color: var(--muted); font-style: italic; background: rgb(248, 250, 252); padding: 12px; border-radius: 6px; border: 1px dashed var(--border);}#bihar-widget-timeline .map-section-title {font-family: "Playfair Display", serif; font-size: 32px; font-weight: 600; margin: 0px 0px 6px; color: rgb(0, 0, 0); line-height: 1.15;}#bihar-widget-timeline .map-helper {color: rgb(0, 0, 0); font-size: 16px; margin: 0px 0px 12px; font-family: "Roboto Slab", serif;}#bihar-widget-timeline .past-results-title {font-family: "Playfair Display", serif; font-size: 32px; font-weight: 600; line-height: 36px; margin: 0px 0px 12px; color: rgb(0, 0, 0);}#bihar-widget-timeline .results-container {display: flex; flex-direction: column; gap: 16px;}#bihar-widget-timeline .muted {color: var(--muted);}#bihar-widget-timeline .badge {display: inline-block; padding: 2px 8px; border-radius: 999px; background: rgb(238, 242, 255); border: 1px solid rgb(229, 231, 235); font-size: 12px;}#bihar-widget-timeline .pill {display: inline-block; padding: 2px 8px; border-radius: 999px; color: rgb(255, 255, 255); font-size: 12px;}#bihar-widget-timeline .kv {display: grid; grid-template-columns: 140px 1fr; gap: 6px 12px;}#bihar-widget-timeline .section-title {font-weight: 600; margin: 0px 0px 8px;}#bihar-widget-timeline .vote-bars {margin-top: 8px;}#bihar-widget-timeline .bar {height: 8px; border-radius: 999px; background: rgb(229, 231, 235); position: relative; margin-bottom: 6px;}#bihar-widget-timeline .bar > span {position: absolute; left: 0px; top: 0px; bottom: 0px; border-radius: 999px;}#bihar-widget-timeline .bar-label {display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 4px;}#bihar-widget-timeline .mono {font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;}#bihar-widget-timeline .hr {height: 1px; background: var(--border); margin: 12px 0px;}#bihar-widget-timeline .note {font-size: 12px; color: var(--muted);}#bihar-widget-timeline .error {color: rgb(185, 28, 28);}#bihar-widget-timeline .disclaimer-footer {margin-top: 40px; padding-top: 20px; border-top: 1px solid var(--border); text-align: center;}#bihar-widget-timeline .disclaimer-text {color: var(--muted); font-size: 11px; line-height: 1.4; font-weight: 400;}#bihar-widget-timeline .trends-container {margin: 20px 0px;}#bihar-widget-timeline .timeline-scroll {overflow-x: auto; padding: 20px 0px; scroll-behavior: smooth;}#bihar-widget-timeline .timeline-container {display: flex; align-items: center; min-width: max-content; padding: 0px 20px; gap: 0px; position: relative;}#bihar-widget-timeline .timeline-year {display: flex; flex-direction: column; align-items: center; position: relative; min-width: 170px; padding: 0px 10px;}#bihar-widget-timeline .timeline-year-badge {background: var(--primary); color: white; font-weight: 700; font-size: 16px; padding: 8px 16px; border-radius: 20px; margin-bottom: 16px; box-shadow: rgba(0, 145, 172, 0.3) 0px 2px 8px; position: relative; z-index: 2;}#bihar-widget-timeline .dott {width: 15px; height: 15px; background: rgb(0, 145, 172); margin: 0px auto; border-radius: 50px; border: 2px solid rgb(255, 255, 255);}#bihar-widget-timeline .timeline-candidate {text-align: center; margin-bottom: 8px; margin-top: 30px;}#bihar-widget-timeline .timeline-candidate-name {font-weight: 600; font-size: 18px; color: var(--text); margin-bottom: 4px;}#bihar-widget-timeline .timeline-party {display: inline-block; padding: 4px 10px; border-radius: 12px; color: white; font-size: 12px; font-weight: 600; box-shadow: rgba(0, 0, 0, 0.15) 0px 2px 4px;}#bihar-widget-timeline .timeline-connection {display: flex; align-items: center; flex-direction: column; min-width: 100px; position: relative;}#bihar-widget-timeline .timeline-line {width: 100%; height: 2px; background: rgb(0, 145, 172); position: absolute; margin: 10px 0px; left: 0px; top: 52px;}#bihar-widget-timeline .timeline-line::before {content: ""; position: absolute; top: 50%; right: -4px; transform: translateY(-50%); width: 0px; height: 0px; border-left: 8px solid var(--border); border-top: 4px solid transparent; border-bottom: 4px solid transparent;}#bihar-widget-timeline .timeline-change {display: flex; align-items: center; gap: 6px; padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; margin-top: 8px;}#bihar-widget-timeline .timeline-hold {background: rgb(220, 252, 231); color: rgb(22, 163, 74);}#bihar-widget-timeline .timeline-gain {background: rgb(254, 243, 199); color: rgb(217, 119, 6);}#bihar-widget-timeline .timeline-hint {display: none; text-align: center; color: var(--muted); font-size: 12px; margin-top: 8px; margin-bottom: 4px; font-style: italic;}#bihar-widget-timeline .election-result {margin-bottom: 16px;}#bihar-widget-timeline .election-title {font-family: "Playfair Display", serif; font-size: 22px; font-weight: 600; line-height: 36px; margin: 0px 0px 12px; color: var(--text);}#bihar-widget-timeline .candidate-row {margin-bottom: 16px;}#bihar-widget-timeline .candidate-info {display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;}#bihar-widget-timeline .candidate-name {font-family: "Roboto Slab", serif; font-weight: 400; font-size: 16px; padding-bottom: 8px;}#bihar-widget-timeline .candidate-party {color: var(--muted); font-size: 14px;}#bihar-widget-timeline .vote-count {font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-weight: 600;}#bihar-widget-timeline .margin-info {margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border);}#bihar-widget-timeline .margin-text {font-family: "Roboto Slab", serif; font-weight: 700; font-size: 12px;}@media (max-width: 767px){#bihar-widget-timeline .past-results-title {font-size: 20px;}#bihar-widget-timeline .timeline-scroll {padding: 16px 0px; scroll-snap-type: x mandatory;}#bihar-widget-timeline .timeline-container {padding: 0px 16px;}#bihar-widget-timeline .timeline-year {min-width: 100px; padding: 0px 8px; scroll-snap-align: center;}#bihar-widget-timeline .timeline-year-badge {font-size: 14px; padding: 6px 12px; margin-bottom: 12px;}#bihar-widget-timeline .timeline-candidate-name {font-size: 12px;}#bihar-widget-timeline .timeline-party {font-size: 11px; padding: 3px 8px;}#bihar-widget-timeline .timeline-connection {min-width: 80px;}#bihar-widget-timeline .timeline-line {top: 41px;}#bihar-widget-timeline .timeline-change {font-size: 10px; padding: 3px 6px;}#bihar-widget-timeline .timeline-hint {display: block;}}@media (min-width: 768px){#bihar-widget-timeline .container {padding: 0px 24px;}#bihar-widget-timeline .search-controls {gap: 16px;}#bihar-widget-timeline .results-container {display: grid; grid-template-columns: 1fr 1fr; gap: 20px;}#bihar-widget-timeline .constituency-title {font-size: 28px;}}@media (min-width: 1024px){#bihar-widget-timeline .results-container {grid-template-columns: 1fr 1fr 1fr;}#bihar-widget-timeline .header-content {padding: 0px 24px;}#bihar-widget-timeline .constituency-title {font-size: 32px;}}</style><script>(function() {  var hasRendered = false;  var renderAttempts = 0;  var maxAttempts = 3;  function initEmbed() {    try {      renderAttempts++;      var parentUrl = '';      try {        parentUrl = window.parent.location.href;      } catch(e) {        parentUrl = document.referrer || window.location.href;      }      var hostEl = document.getElementById('bihar-widget-timeline');      if (!hostEl) {        if (renderAttempts < maxAttempts) {          setTimeout(initEmbed, 500);        }        return;      }      if (hasRendered && hostEl.innerHTML.length > 200) {        return;      }      hostEl.innerHTML = '<div style="padding:20px;text-align:center;color:#666;">Loading...</div>';      function extractSlug(url) {        try {          var urlObj = new URL(url);          var path = urlObj.pathname;          var match = path.match(/\/([^\/]+?)(?:-assembly)?-election-\d{4}/i);          if (match && match[1]) return match[1];          var parts = path.split('/').filter(function(p){ return p.length > 0; });          if (parts.length > 1) {            var lastPart = parts[parts.length - 1];            var cleaned = lastPart.replace(/-\d{4}-\d+$/, '').replace(/-assembly-election.*$/, '').replace(/-election.*$/, '');            if (cleaned) return cleaned;          }          return null;        } catch(e) {          return null;        }      }      var slug = extractSlug(parentUrl);      if (!slug) {        hostEl.innerHTML = '<div style="padding:20px;color:#b91c1c;">Could not extract constituency from URL</div>';        return;      }      function detectDataSource() {        var host = window.location.hostname.toLowerCase();        if (host.includes('quintype.io') || host.includes('sandbox')) return 'sandbox';        return 'github';      }      var dataSource = detectDataSource();      var filesConfig = {        github: {          parties: 'https://suhastpml.github.io/Bihar_constituency_page/parties.json',          consolidated: 'https://suhastpml.github.io/Bihar_constituency_page/bihar_election_results_consolidated.json'        },        sandbox: {          parties: 'https://dh-sandbox-web.quintype.io/parties.json',          consolidated: 'https://dh-sandbox-web.quintype.io/bihar_election_results_consolidated'        }      };      var FILES = filesConfig[dataSource];      Promise.all([        fetch(FILES.parties).then(function(r){ return r.json(); }),        fetch(FILES.consolidated).then(function(r){ return r.json(); })      ]).then(function(results) {        var parties = results[0];        var consolidated = results[1];        var constituency = null;        for (var i = 0; i < consolidated.length; i++) {          if (consolidated[i].slug === slug) {            constituency = consolidated[i];            break;          }        }        if (!constituency) {          var urlLower = parentUrl.toLowerCase();          for (var i = 0; i < consolidated.length; i++) {            var constSlug = consolidated[i].slug;            if (constSlug && urlLower.includes(constSlug)) {              constituency = consolidated[i];              break;            }          }        }        if (!constituency) {          hostEl.innerHTML = '<div style="padding:20px;color:#b91c1c;">Constituency not found</div>';          return;        }        // Build party index        var partiesIdx = {};        parties.forEach(function(p) { partiesIdx[p.code] = p; });        var PARTY_NORMALIZE = { 'JDU': 'JD(U)', 'CPM': 'CPI(M)', 'HAM': 'HAM(S)', 'Ind': 'IND' };        function normalizeParty(code) {          if (!code) return code;          var c = code.trim();          return PARTY_NORMALIZE[c] || c;        }        function enrichParty(code, idx) {          var norm = normalizeParty(code || '');          var meta = idx[norm] || idx[code] || null;          return {            code: norm || null,            name: meta ? meta.name : null,            color: meta ? meta.color : '#888'          };        }        function recFromConsolidated(row, year) {          if (!row) return null;          var y = String(year);          var wName = row['y' + y + '_winner_name'];          var wParty = row['y' + y + '_winner_party'];          var wVotes = row['y' + y + '_winner_votes'];          var margin = row['y' + y + '_margin'];          // Only return a record if there's a winner name          if (!wName || (typeof wName === 'string' && wName.trim() === '')) return null;          return {            'Winner': { Candidate: wName || '-', Party: wParty || '-', Votes: wVotes || '0' }          };        }        var r2010 = recFromConsolidated(constituency, 2010);        var r2015 = recFromConsolidated(constituency, 2015);        var r2020 = recFromConsolidated(constituency, 2020);        var r2025 = recFromConsolidated(constituency, 2025);        function partyOf(rec) { return normalizeParty((rec && rec['Winner'] && rec['Winner'].Party) || ''); }        function nameOf(rec) { return (rec && rec['Winner'] && rec['Winner'].Candidate) || null; }        var elections = [          { year: '2010', rec: r2010, party: partyOf(r2010), name: nameOf(r2010) },          { year: '2015', rec: r2015, party: partyOf(r2015), name: nameOf(r2015) },          { year: '2020', rec: r2020, party: partyOf(r2020), name: nameOf(r2020) },          { year: '2025', rec: r2025, party: partyOf(r2025), name: nameOf(r2025) }        ].filter(function(e) { return e.rec; });        // If 2025 data exists, reverse to show newest first        var has2025 = false;        for (var i = 0; i < elections.length; i++) {          if (elections[i].year === '2025') {            has2025 = true;            break;          }        }        if (has2025) {          elections.reverse();        }        if (elections.length === 0) {          hostEl.innerHTML = '<div class="card"><h3 class="past-results-title">Bihar Assembly Elections ' + constituency.constituency_name + ' Past Results</h3><div class="trends-container"><div class="muted">No election data available</div></div></div>';          hasRendered = true;          return;        }        var timelineHTML = '';        elections.forEach(function(election, index) {          var party = enrichParty(election.party, partiesIdx);          timelineHTML += '<div class="timeline-year">' +            '<div class="timeline-year-badge">' + election.year + '</div>' +            '<div class="dott"></div>' +            '<div class="timeline-candidate">' +              '<div class="timeline-candidate-name">' + (election.name || '—') + '</div>' +              '<div class="timeline-party" style="background: ' + party.color + '">' + (party.code || '—') + '</div>' +            '</div>' +          '</div>';          if (index < elections.length - 1) {            var nextElection = elections[index + 1];            var isHold = election.party === nextElection.party;            var changeClass = isHold ? 'timeline-hold' : 'timeline-gain';            var changeText = isHold ? 'HOLD' : 'GAIN';            timelineHTML += '<div class="timeline-connection">' +              '<div class="timeline-change ' + changeClass + '">' + changeText + '</div>' +            '</div>';          }        });        var html = '<div class="card">' +          '<h3 class="past-results-title">Bihar Assembly Elections ' + constituency.constituency_name + ' Past Results</h3>' +          '<div class="trends-container">' +            '<div class="timeline-scroll">' +              '<div class="timeline-container">' +                '<div class="timeline-line"></div>' +                timelineHTML +              '</div>' +            '</div>' +            '<div class="timeline-hint">← Timeline can be scrolled horizontally →</div>' +          '</div>' +        '</div>';        hostEl.innerHTML = html;        hasRendered = true;      }).catch(function(err) {        hostEl.innerHTML = '<div style="padding:20px;color:#b91c1c;">Error loading data</div>';      });    } catch(e) {      if (renderAttempts < maxAttempts) {        setTimeout(initEmbed, 500);      }    }  }  if (document.readyState === 'loading') {    document.addEventListener('DOMContentLoaded', initEmbed);  } else {    initEmbed();  }  setTimeout(initEmbed, 100);  setTimeout(initEmbed, 500);  window.addEventListener('load', initEmbed);})();</script>